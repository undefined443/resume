\ProvidesExplPackage{cjk-fonts}{2025/01/19} {3.0} {CJK fonts configuration with Noto fonts using LaTeX3}

\RequirePackage{xeCJK}

% 设置 CJK 字体作为主要字体
% 思源宋体 (Noto Serif CJK SC) 作为主字体
% CJK = Chinese-Japanese-Korean，支持中日韩文字
\setCJKmainfont[
  BoldFont=NotoSerifCJKsc-Bold,
  ItalicFont=NotoSerifCJKsc-Regular,  % 思源宋体没有斜体，使用常规体
  SmallCapsFont=NotoSerifCJKsc-Medium
]{NotoSerifCJKsc-Regular}

% 思源黑体 (Noto Sans CJK SC) 作为无衬线字体
\setCJKsansfont{NotoSansCJKsc-Regular}

% 思源等宽字体使用思源黑体
\setCJKmonofont{NotoSansCJKsc-Regular}

% Use LaTeX3 to define font families and commands
\ExplSyntaxOn

% Define font family mappings
\prop_new:N \g_cjk_fonts_family_prop

% Populate font family mappings
\prop_put:Nnn \g_cjk_fonts_family_prop {zhsong} {NotoSerifCJKsc-Regular}
\prop_put:Nnn \g_cjk_fonts_family_prop {zhhei} {NotoSansCJKsc-Regular}
\prop_put:Nnn \g_cjk_fonts_family_prop {zhhei-bold} {NotoSansCJKsc-Bold}
\prop_put:Nnn \g_cjk_fonts_family_prop {zhfs} {NotoSansCJKsc-Regular}
\prop_put:Nnn \g_cjk_fonts_family_prop {zhkai} {NotoSerifCJKsc-Regular}
\prop_put:Nnn \g_cjk_fonts_family_prop {zhkai-medium} {NotoSerifCJKsc-Medium}
\prop_put:Nnn \g_cjk_fonts_family_prop {zhli} {NotoSerifCJKsc-Regular}
\prop_put:Nnn \g_cjk_fonts_family_prop {zhyou} {NotoSansCJKsc-Regular}

% Define all font families using LaTeX3
\seq_map_function:nN
  { zhsong, zhhei, zhhei-bold, zhfs, zhkai, zhkai-medium, zhli, zhyou }
  \cjk_fonts_define_family:Nn

\cs_new_protected:Nn \cjk_fonts_define_family:Nn
  {
    \setCJKfamilyfont{#1} {\prop_item:Nn \g_cjk_fonts_family_prop {#1}}
  }

% Define font commands with LaTeX3
\NewDocumentCommand \songti { } { \CJKfamily{zhsong} }
\NewDocumentCommand \heiti { } { \CJKfamily{zhhei} }
\NewDocumentCommand \kaishu { } { \CJKfamily{zhkai} }
\NewDocumentCommand \fangsong { } { \CJKfamily{zhfs} }
\NewDocumentCommand \lishu { } { \CJKfamily{zhli} }
\NewDocumentCommand \youyuan { } { \CJKfamily{zhyou} }

% Provide specific commands for bold variants
\NewDocumentCommand \heitibold { } { \CJKfamily{zhhei-bold} }
\NewDocumentCommand \kaiishumedium { } { \CJKfamily{zhkai-medium} }

% Utility commands for font switching
\NewDocumentCommand \cjkfontssongti { m } { \songti #1 }
\NewDocumentCommand \cjkfontsheiti { m } { \heiti #1 }
\NewDocumentCommand \cjkfontskaishu { m } { \kaishu #1 }

\ExplSyntaxOff

\endinput
